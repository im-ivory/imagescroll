<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
      html {
  height: 100vh;
}

body {
  height: 500vh;
  background: #000;
}

canvas {
  position: fixed;
  /* left: 50%; */
  top: 0;
  /* transform: translate(-50%, -50%); */
  max-width: 100vw;
  max-height: 100vh;
}
div{
    height: 100vh;
}
    </style>
</head>
<body>
    <canvas id="hero-lightpass" />
    </canvas>
    <div>
        HELLO
    </div>
    <script>
const html = document.documentElement;
const canvas = document.getElementById("hero-lightpass");
const context = canvas.getContext("2d");

const frameCount = 197; // ì „ì²´ ì‚¬ì§„ ê°¯ìˆ˜? Maybe
const currentFrame = index => ( // function currentFrame(index)
  `../content/dongatest/dongatest (${ index.toString().padStart(1, '0')}).jpg`
) // currentFrameì€ í•¨ìˆ˜ì¸ë°, ì¸ìë¡œ ìˆ«ì ì•ì— 0ì„ ë¶™ì—¬ì„œ 4ìë¦¬ìˆ˜ë¡œ ë§Œë“ ë‹¤. ì˜ˆ) currentFrame(1) -> /0001.jpg

// const preloadImages = () => {
//   for (let i = 1; i < frameCount; i++) {
//     const img = new Image(); 
//     img.src = currentFrame(i); // img 0001, 0002, 0003 ì´ë¯¸ì§€ë¥¼ ë¯¸ë¦¬ ë‹¤ ë¡œë“œí•´ë†“ëŠ”ê²ƒ
//   }
// };

const img = new Image(); //ì´ë¯¸ì§€ ê°ì²´ ìƒì„±
img.src = currentFrame(1); //ì´ë¯¸ì§€ì˜ ì£¼ì†ŒëŠ” ìœ„ì˜ currentFrame í•¨ìˆ˜ ì¸ìë¡œ 1, ì¦‰ 0001.jpg ë§¨ ì²˜ìŒ ì‚¬ì§„
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;
img.onload=function(){ //onload: í˜ì´ì§€ê°€ ì½í˜€ì§€ë©´ ë°”ë¡œ ì‹¤í–‰í•˜ëŠ” ì´ë²¤íŠ¸
  context.drawImage(img, 0, 0); //ì´ë¯¸ì§€ê°€ ë¡œë“œë˜ë©´, ìº”ë²„ìŠ¤ ì™¼ìª½ìœ„ë¶€í„° ì±„ì›Œì„œ ì´ë¯¸ì§€ë¥¼ ê·¸ë¦°ë‹¤.
}

const updateImage = index => { // ğŸ’› function updateImage(index) ì´ë¯¸ì§€ë¥¼ ë°”ê¾¸ëŠ” í•¨ìˆ˜
  img.src = currentFrame(index); // ì´ë¯¸ì§€ ì£¼ì†ŒëŠ” ì…ë ¥ë°›ì€ ì¸ì(index)
  context.drawImage(img, 0, 0); // ì…ë ¥ë°›ì€ ì£¼ì†Œì˜ ì´ë¯¸ì§€ë¥¼ ì¶œë ¥í•œë‹¤.
}

window.addEventListener('scroll', () => {  // ìŠ¤í¬ë¡¤í•  ë•Œë§ˆë‹¤ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜
  const scrollTop = html.scrollTop; // scrollTop = í˜„ì¬ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ê°€ ìœ„ì—ì„œë¶€í„° ì–¼ë§ˆë‚˜ ë–¨ì–´ì ¸ìˆëŠ”ì§€
  const maxScrollTop = html.scrollHeight - window.innerHeight; // maxScrollTop = ì „ì²´ ìŠ¤í¬ë¡¤ê°’ - í˜„ì¬ ìœˆë„ìš°ì°½ ì„¸ë¡œê¸¸ì´ = ìŠ¤í¬ë¡¤ë  ìˆ˜ ìˆëŠ” ìµœëŒ€ê°’ = scrollTopì˜ ìµœëŒ€ê°’ = 3022
  const scrollFraction = scrollTop / maxScrollTop; // í˜„ì¬ ìŠ¤í¬ë¡¤ì´ ì „ì²´ì—ì„œ ëª‡%ë‚˜ ìŠ¤í¬ë¡¤ëëŠ”ì§€. ì˜ˆ) scrollTop 200ì´ë©´ 0.06
  const frameIndex = Math.min( //Math.min ë‘ ê°œ ì¤‘ ë” ì‘ì€ ê°’ì„ ë°˜í™˜
    frameCount - 1, // 148-1 = 147
    Math.ceil(scrollFraction * frameCount) // Math.ceil ì†Œìˆ˜ì  ì´í•˜ë¥¼ ì˜¬ë¦¼í•œë‹¤. 8.88 -> 9 // ìŠ¤í¬ë¡¤ì´ ë‹¤ ë˜ë©´ 148ì´ ë í…Œë‹ˆ ê·¸ë•ŒëŠ” 147ì´ ë¨
  );  // ê³±í•˜ëŠ” ì´ìœ ëŠ” ë‚˜ëˆ ì§„ ìŠ¤í¬ë¡¤ì— ë”°ë¼ ì´ë¯¸ì§€ë¥¼ ë°°ë¶„í•˜ê¸° ìœ„í•´..(?)

//   console.log(scrollTop,scrollFraction, frameIndex);
  
  requestAnimationFrame(() => updateImage(frameIndex + 1)) // ğŸ’› +1 í•˜ëŠ” ì´ìœ ëŠ” ë¡œë“œë ë•Œ ì´ë¯¸ frameIndex 1ì¸ ìƒíƒœì´ê¸° ë•Œë¬¸ì— 2ë¶€í„° ë¶ˆëŸ¬ì˜¤ë ¤ê³ ?
});

// preloadImages();
    </script>
</body>
</html>